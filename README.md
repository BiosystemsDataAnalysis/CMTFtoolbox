
<!-- README.md is generated from README.Rmd. Please edit that file -->

# CMTFtoolbox

<!-- badges: start -->

[![R-CMD-check](https://github.com/GRvanderPloeg/CMTFtoolbox/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/GRvanderPloeg/CMTFtoolbox/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

## Overview

The ‘CMTFtoolbox’ package enables R users with two matrix and tensor
factorization methods that have previously been presented in the Matlab
sphere:

- ‘cmtf_opt’: Coupled Matrix and Tensor Factorization (CMTF).
- ‘acmtf_opt’: Advanced Coupled Matrix and Tensor Factorization (ACMTF).

Other features are pending.

## Installation

You can install the development version of ‘CMTFtoolbox’ from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("GRvanderPloeg/CMTFtoolbox")
```

## Citation

Pending

## Usage

``` r
library(CMTFtoolbox)

set.seed(123)
numComponents = 3
I = 108
J = 100
K = 10
L = 100
A = array(rnorm(I*numComponents), c(I, numComponents))  # shared subject mode
B = array(rnorm(J*numComponents), c(J, numComponents))  # distinct feature mode of X1
C = array(rnorm(K*numComponents), c(K, numComponents))  # distinct condition mode of X1
D = array(rnorm(L*numComponents), c(L, numComponents))  # distinct feature mode of X2
lambdas = array(c(1, 1, 1, 0, 0, 1), c(2,3))

df1 = array(0L, c(I, J, K))
df2 = array(0L, c(I, L))
for(i in 1:numComponents){
  df1 = df1 + lambdas[1,i] * reinflateTensor(A[,i], B[,i], C[,i])
  df2 = df2 + lambdas[2,i] * reinflateMatrix(A[,i], D[,i])
}
datasets = list(df1, df2)
modes = list(c(1,2,3), c(1,4))
Z = setupCMTFdata(datasets, modes, normalize=TRUE)

cmtf_model = cmtf_opt(Z, 3)
#> [[1]]
#> [[1]]$f
#> [1] 0.212898
#> 
#> [[1]]$g2n
#> [1] 0.006162322
#> 
#> [[1]]$nf
#> [1] 1737
#> 
#> [[1]]$ng
#> [1] 1737
#> 
#> [[1]]$par
#>   [1]  6.344173e-01  2.655995e-01 -1.733170e+00 -6.294654e-02 -1.432800e-01
#>   [6] -1.923704e+00 -5.277887e-01  1.414939e+00  7.703277e-01  4.964187e-01
#>  [11] -1.363034e+00 -3.967901e-01 -4.635056e-01 -1.181550e-01  6.008786e-01
#>  [16] -1.999388e+00 -5.603433e-01  2.204313e+00 -7.790235e-01  5.374802e-01
#>  [21]  1.199157e+00  2.402885e-01  1.148839e+00  8.257882e-01  7.062514e-01
#>  [26]  1.895283e+00 -9.523988e-01 -1.582513e-01  1.273690e+00 -1.426565e+00
#>  [31] -4.699931e-01  3.418851e-01 -9.929603e-01 -9.885784e-01 -9.180324e-01
#>  [36] -7.591043e-01 -6.176184e-01  6.745766e-02  3.237039e-01  4.278058e-01
#>  [41]  7.679130e-01  2.233201e-01  1.422151e+00 -2.416792e+00 -1.348383e+00
#>  [46]  1.263769e+00  4.433194e-01  5.019021e-01 -9.019616e-01  7.203300e-02
#>  [51] -2.864328e-01  5.223130e-02  4.963859e-02 -1.529417e+00  2.432121e-01
#>  [56] -1.706650e+00  1.731400e+00 -6.295387e-01 -1.504250e-01 -2.354630e-01
#>  [61] -4.287310e-01  5.663164e-01  3.681981e-01  1.134345e+00  1.219658e+00
#>  [66] -3.466447e-01 -5.078166e-01 -5.867960e-02 -1.029143e+00 -2.292877e+00
#>  [71]  5.421574e-01  2.568798e+00 -1.117696e+00  7.948761e-01  7.563735e-01
#>  [76] -1.157717e+00  3.033831e-01  1.375363e+00 -2.249003e-01  1.543919e-01
#>  [81] -2.288747e-02 -4.178369e-01  4.166094e-01 -7.344969e-01  2.577401e-01
#>  [86] -3.606923e-01 -1.223338e+00 -4.711670e-01  3.699285e-01 -1.291865e+00
#>  [91] -1.087064e+00 -6.183120e-01 -2.835691e-01  6.788066e-01 -1.534405e+00
#>  [96]  6.662527e-01 -2.428572e+00 -1.707490e+00  2.687616e-01  1.140822e+00
#> [101]  8.025254e-01 -2.705903e-01  2.556808e-01  3.779716e-01  1.065420e+00
#> [106]  3.815847e-02  8.971827e-01  1.862137e+00 -2.449868e-05  5.835746e-05
#> [111] -4.058350e-05  3.713395e-05 -1.049576e-04 -4.768072e-06  3.447272e-05
#> [116]  2.171676e-05  7.144056e-06 -4.057078e-05 -5.711193e-05 -6.730520e-05
#> [121]  8.506413e-06 -6.242309e-05 -2.809336e-05 -1.870132e-05  1.183827e-04
#> [126] -4.057651e-05  1.350006e-05  3.826561e-06 -6.094606e-05 -3.750731e-06
#> [131]  9.452026e-05  2.874542e-05  2.299951e-06 -2.597332e-05 -1.309817e-04
#> [136]  7.094784e-05 -9.284691e-05  4.893900e-05  1.220336e-04 -9.443638e-05
#> [141]  4.310149e-05 -1.719298e-05 -1.025997e-04 -9.921703e-05 -1.041597e-04
#> [146] -3.393559e-05 -9.135627e-05  4.455770e-05  1.374482e-04 -8.159468e-05
#> [151]  5.189453e-05  4.486922e-05  1.925379e-05 -6.430142e-05 -6.965806e-06
#> [156] -1.546176e-05  3.871181e-05 -2.152407e-05  6.248140e-05 -2.662830e-05
#> [161]  6.728996e-05 -6.907311e-05 -7.959169e-05  2.081118e-04 -2.414884e-05
#> [166]  1.624866e-05  4.210119e-05 -3.206017e-05  3.311018e-05  2.431534e-05
#> [171] -1.284723e-05  5.572514e-06 -3.381387e-06  1.376274e-04 -4.762164e-05
#> [176] -7.090867e-05  1.406232e-06  1.767919e-05  2.910981e-05 -2.446487e-05
#> [181] -7.005741e-05  8.227987e-05 -1.998045e-05 -5.541803e-05 -1.314483e-05
#> [186] -1.215277e-05  7.409183e-05  5.720104e-06  5.110349e-05 -3.449270e-05
#> [191]  1.421478e-05 -1.985688e-05  5.234526e-06 -5.914666e-05 -8.683508e-05
#> [196]  1.263661e-04  3.839563e-05 -8.132350e-05 -4.347047e-05 -7.656154e-05
#> [201]  1.430523e-04  8.816445e-05 -1.685347e-05  3.668081e-05 -3.174211e-05
#> [206] -3.334706e-05 -5.099899e-05 -3.602959e-05  1.067506e-04 -5.673298e-06
#> [211]  1.044234e-05  1.742872e-05  8.069002e-05 -3.142237e-05 -6.496977e-05
#> [216]  1.106718e-04  4.080639e-01  1.641859e-01 -1.144917e+00 -5.689170e-02
#> [221] -1.004675e-01 -1.246233e+00 -3.303094e-01  9.309779e-01  4.976185e-01
#> [226]  3.243053e-01 -8.971129e-01 -2.674708e-01 -2.911846e-01 -8.953868e-02
#> [231]  4.157801e-01 -1.304307e+00 -3.625791e-01  1.427644e+00 -5.148518e-01
#> [236]  3.340891e-01  7.793462e-01  1.617721e-01  7.527908e-01  5.285898e-01
#> [241]  4.505992e-01  1.229134e+00 -6.022967e-01 -1.172008e-01  8.279870e-01
#> [246] -9.063542e-01 -3.075960e-01  2.060687e-01 -6.554183e-01 -6.383497e-01
#> [251] -6.029977e-01 -5.017172e-01 -4.067917e-01  4.508079e-02  2.307270e-01
#> [256]  2.777461e-01  5.138479e-01  1.533460e-01  9.255375e-01 -1.594156e+00
#> [261] -8.852985e-01  8.176659e-01  2.895482e-01  3.431982e-01 -5.595837e-01
#> [266]  6.606768e-02 -1.883299e-01  1.236651e-02  2.757067e-02 -9.957558e-01
#> [271]  1.689579e-01 -1.100516e+00  1.136965e+00 -4.275721e-01 -8.756272e-02
#> [276] -1.589915e-01 -2.772762e-01  3.700242e-01  2.452728e-01  7.396872e-01
#> [281]  7.743825e-01 -2.168480e-01 -3.262203e-01 -4.152401e-02 -6.693355e-01
#> [286] -1.492834e+00  3.561111e-01  1.694566e+00 -7.312230e-01  5.201642e-01
#> [291]  5.074212e-01 -7.415785e-01  2.118855e-01  8.893183e-01 -1.218844e-01
#> [296]  1.014517e-01  8.112118e-03 -2.890162e-01  2.717980e-01 -4.633170e-01
#> [301]  1.591525e-01 -2.443773e-01 -8.089333e-01 -3.201043e-01  2.357198e-01
#> [306] -8.379384e-01 -7.334031e-01 -4.003931e-01 -1.695610e-01  4.675895e-01
#> [311] -9.840578e-01  4.435901e-01 -1.604242e+00 -1.120363e+00  1.708342e-01
#> [316]  7.522566e-01  5.217608e-01 -1.919097e-01  1.874376e-01  2.576025e-01
#> [321]  6.973588e-01  3.990697e-02  5.682470e-01  1.221876e+00  6.374615e-01
#> [326] -3.425840e-01 -7.159687e-01 -5.784883e-01 -7.923399e-01 -2.193926e+00
#> [331] -1.379332e+00  2.966123e-01  2.709708e-01 -1.679465e+00 -2.375237e+00
#> [336]  4.081286e-01  9.606005e-01  1.823530e+00 -2.205983e-01  6.647397e-01
#> [341]  6.831366e-02 -4.087241e-01 -7.434255e-01 -9.995327e-01 -3.016921e-01
#> [346]  1.593116e+00 -4.440263e-01  8.065741e-02 -2.426465e-01  2.101808e-01
#> [351] -4.196463e-01  8.936683e-01 -8.913525e-01  2.629590e-01 -6.276469e-01
#> [356] -3.871289e-01  9.632423e-01  1.482543e-02  1.523911e+00 -2.094939e+00
#> [361] -2.185884e-01 -8.356134e-02 -6.078113e-01 -2.039290e+00  6.858425e-01
#> [366]  4.794756e-01 -6.812240e-01 -1.113724e+00  1.307339e+00  3.055978e+00
#> [371] -9.524767e-01  1.404998e+00  8.133938e-01 -5.964831e-01 -4.696742e-01
#> [376] -1.299576e+00 -6.016908e-01  3.267576e-01 -2.265311e-01  7.359737e-01
#> [381] -2.200834e-01 -1.864739e+00  6.436871e-01 -7.291816e-01 -4.491012e-01
#> [386] -1.188824e+00 -6.819316e-01  1.644718e+00 -2.563661e-01 -1.161528e+00
#> [391] -9.803311e-01 -7.456258e-02 -1.347874e+00  5.547102e-01 -3.004041e-02
#> [396] -4.167649e-01  2.472419e-01 -1.359960e+00  2.115862e-01  6.376373e-01
#> [401]  5.305825e-01  2.516944e+00  1.791996e-01 -9.129657e-01 -6.571771e-01
#> [406]  9.601092e-01  1.889343e+00 -5.157201e-01  1.168509e+00  3.809752e-01
#> [411] -1.041267e+00  3.731046e-02  5.192404e-01  7.085572e-01  6.332283e-01
#> [416]  1.594378e+00 -7.044178e-01 -1.093412e+00  1.003789e+00 -7.371277e-01
#> [421] -1.178036e+00  1.627689e-01 -1.133790e+00 -1.093030e+00 -9.724356e-01
#> [426]  5.540816e-01  2.638564e-01  3.626090e-01  3.118496e-01  5.355226e-01
#> [431]  5.604522e-01 -1.699313e+00 -1.471041e-01  1.562673e-01  6.124323e-01
#> [436] -9.786279e-01 -4.706690e-01 -9.594097e-01  1.009536e+00  1.024679e+00
#> [441]  7.331901e-01 -1.047733e+00  3.686486e-01  9.829123e-01  1.706309e-01
#> [446] -5.041336e-01 -9.400262e-01 -6.109533e-01  6.914482e-01 -2.917014e-01
#> [451]  1.357619e-01  1.026968e+00  4.637735e-01  1.125677e+00 -1.496381e+00
#> [456] -1.114454e-01  9.357288e-03  5.138804e-01 -1.026871e+00  7.210893e-01
#> [461]  2.175895e-01  2.463729e-01  4.091384e-01 -7.272498e-02  8.453642e-01
#> [466]  4.917031e-01 -1.588291e-01  7.898875e-01  2.564816e-01  5.139508e-01
#> [471] -5.709921e-01  1.336739e+00  5.329181e-02  7.389151e-01 -6.988201e-02
#> [476] -2.527651e-01  5.721324e-01 -1.326263e+00  3.876218e-01  3.261472e-01
#> [481] -2.285848e+00  2.962922e-01 -1.897026e+00  5.410708e-01 -4.136448e-01
#> [486] -6.127008e-01 -4.532672e-02  1.180466e+00 -6.193922e-01  4.918874e-01
#> [491]  2.856184e-01 -1.089863e+00 -1.528390e+00 -1.646791e+00  5.029144e-01
#> [496]  4.962142e-02  1.552127e+00  4.863694e-01  6.907100e-01  1.101674e+00
#> [501] -3.970930e-01  4.706066e-01  6.816142e-01  1.124923e+00  7.239307e-01
#> [506]  3.445440e-01 -6.947597e-01  7.216584e-01  4.128363e-01  5.438924e-01
#> [511]  3.678804e-01 -1.773540e-01 -9.920591e-02  5.725369e-01  1.708280e-01
#> [516] -6.957179e-01 -2.427924e-01 -1.128956e+00 -7.634480e-01 -1.205509e-01
#> [521] -1.550507e+00 -1.423506e+00  9.667626e-01 -4.638450e-01  4.231667e-01
#> [526] -6.692371e-01  2.556062e-01 -5.466565e-01 -1.318953e+00  7.486448e-01
#> [531] -7.051542e-01  1.266143e+00  7.472815e-01 -1.179467e+00  3.427233e-01
#> [536]  2.257545e+00  1.239880e+00 -3.929141e-01 -8.823934e-01 -1.509092e-01
#> [541] -7.146209e-01 -9.876618e-01 -1.711854e+00  2.671072e-01  1.638471e-01
#> [546]  1.497652e+00  3.402438e-02  6.237636e-01  1.261424e+00  1.621138e-01
#> [551] -1.075260e+00  1.974703e+00  7.866416e-01 -2.285998e-01  1.222694e+00
#> [556] -2.168391e-01 -8.221467e-01  5.783510e-02  2.338957e+00 -2.286004e+00
#> [561]  2.993838e-01 -7.273474e-01 -1.194391e-01 -5.011088e-01 -1.160490e+00
#> [566]  6.297452e-02 -2.241798e-01  1.446732e+00 -1.433396e+00 -5.147295e-01
#> [571] -2.524110e+00  1.448118e+00  2.739549e-01 -7.397099e-01 -4.283266e-01
#> [576]  1.115482e+00  1.313506e+00 -2.772340e-01  8.664892e-02  1.839628e+00
#> [581]  2.859803e-02  3.940033e-01 -4.445546e-01  1.469339e+00 -4.171762e-01
#> [586] -1.222424e+00 -3.275941e-01  7.725367e-01  5.633456e-01 -1.590105e-02
#> [591]  1.084076e+00  2.491319e+00 -5.963709e-01  7.899873e-01  7.083870e-01
#> [596] -1.580980e+00  8.139697e-01 -5.187198e-01  1.397630e+00  1.776751e-01
#> [601] -9.184988e-02  5.388546e-01  6.544671e-01  3.397158e-01 -5.188593e-01
#> [606]  1.590858e+00 -2.092761e-01 -6.758411e-01  2.283378e-01 -3.964746e-01
#> [611] -2.130390e-01 -3.168283e-01 -9.602204e-01 -1.027317e-01  2.806252e-01
#> [616]  2.545981e+00  3.355726e-01 -1.300545e-01 -9.355624e-01  9.040624e-01
#> [621] -1.673558e+00 -3.947215e-01  2.480616e-01 -1.106531e+00 -4.937705e-04
#> [626]  5.507572e-04  9.807374e-05 -6.161857e-04 -7.994887e-04  1.198952e-03
#> [631] -3.842082e-04 -1.065354e-03  3.047663e-04  1.746409e-04  2.258484e+00
#> [636]  1.056810e+00 -2.498210e+00 -1.302785e-02 -5.796727e-01 -1.298508e+00
#> [641]  3.697592e-01  1.175815e-01 -3.797593e-01  2.261123e+00 -2.304469e-03
#> [646]  2.464355e-03  4.478876e-04 -2.788967e-03 -3.643285e-03  5.479215e-03
#> [651] -1.785437e-03 -4.872841e-03  1.401306e-03  8.171039e-04 -8.316571e-01
#> [656]  2.189821e-01  5.308120e-01  1.324882e-01 -5.227142e-02 -5.894604e-01
#> [661] -3.340043e-01 -5.932135e-02  4.999842e-01  3.188777e-01  6.707328e-02
#> [666] -9.214282e-01  6.667407e-01 -3.912153e-01  1.931780e-01 -6.027783e-01
#> [671]  4.125577e-01 -5.237444e-02  3.918172e-01 -3.161745e-01 -5.402912e-01
#> [676] -6.976071e-01 -2.928664e-01 -6.719648e-01 -4.612682e-01  4.952596e-02
#> [681] -1.751063e-01  3.527717e-01  6.679258e-02 -4.326699e-01 -1.940398e-01
#> [686] -1.673748e-01  3.727062e-01  2.120680e-01  2.819164e-01 -1.304423e-01
#> [691]  3.670241e-01 -2.104137e-01  3.930426e-01 -6.696437e-01 -1.591361e-01
#> [696]  2.465436e-01 -1.058228e-01  1.337020e-01 -1.211715e-01 -8.876963e-02
#> [701]  3.676007e-01  2.836136e-01 -1.050806e-01 -5.904554e-01 -3.890106e-01
#> [706]  2.130368e-01 -2.929694e-01  1.380233e-02 -1.121550e-01 -1.012723e-01
#> [711] -9.308441e-01  4.289670e-01 -3.660560e-02  6.469927e-01 -2.050307e-01
#> [716] -3.862224e-01 -5.221136e-01  7.061097e-01 -1.455341e-01 -5.802362e-01
#> [721]  1.520370e-01  8.861665e-02  2.592756e-02 -1.406214e-01 -2.413638e-01
#> [726] -4.695879e-01  3.588951e-02 -7.453769e-02 -8.978110e-01 -1.560410e-01
#> [731] -6.961773e-02  4.927090e-01  2.124078e-03  6.666537e-02  1.178414e-03
#> [736]  2.058136e-01  2.478320e-01  2.573049e-01  7.984769e-02 -4.913766e-01
#> [741] -3.782565e-01  1.288770e-01  6.068010e-01  3.035025e-01  1.655771e-01
#> [746] -3.581734e-02  2.415266e-01 -7.302000e-01  8.633690e-02  4.539272e-01
#> [751]  5.866141e-02  3.507345e-01 -5.474914e-02 -8.317420e-02  1.679847e-01
#> [756]  6.390347e-03 -1.298922e-02  2.155094e-01 -4.698437e-02 -9.018148e-04
#> [761] -9.125099e-02 -1.417833e-01 -8.098435e-02  7.591480e-02  2.286613e-01
#> [766]  5.579497e-02 -1.378718e-01  3.384404e-01  1.680004e-02 -1.400886e-01
#> [771]  4.623502e-02 -9.421462e-02 -2.624344e-01  1.696378e-01 -1.337476e-01
#> [776]  1.789840e-01  5.881631e-02 -1.971897e-01 -2.250560e-01  1.387732e-02
#> [781] -1.048935e-01  6.754991e-02 -6.826523e-02  1.842257e-01  9.755266e-02
#> [786] -7.911726e-02 -6.965806e-03 -1.891448e-01  5.160781e-02  3.505518e-01
#> [791]  2.307610e-01 -2.107708e-01 -2.469876e-01 -1.972787e-01  2.087307e-01
#> [796] -1.697169e-01 -4.586990e-01  2.374108e-01  3.055106e-01 -1.169552e-01
#> [801]  9.371511e-02  7.355874e-02  1.680648e-01  7.736162e-02  7.769331e-03
#> [806] -2.411014e-01  6.857202e-02 -1.858367e-01 -1.358236e-01 -1.063774e-01
#> [811]  1.607860e-01 -1.004812e-02 -6.610417e-02  6.279866e-02  2.754884e-01
#> [816]  2.191717e-01  3.215374e-02  2.320327e-01  1.955023e-01 -5.701164e-02
#> [821] -7.603829e-02  3.198353e-01  3.576546e-01 -2.411935e-01  5.688091e-03
#> [826]  1.202772e-01  3.165870e-02 -1.825478e-01  9.037170e-02 -1.179067e-01
#> [831]  2.973446e-02  2.306156e-01  1.596083e-01 -2.001588e-01 -4.079849e-02
#> [836] -7.427270e-02 -4.787380e-02 -3.019706e-02  2.131323e-01 -4.581128e-02
#> [841]  7.476371e-02 -6.204049e-02 -3.660378e-02 -4.457111e-02  1.372726e-02
#> [846] -2.665660e-03  3.605444e-02 -1.345441e-01 -1.600682e-01  3.856160e-01
#> [851]  1.854598e-01 -3.110941e-01  8.203851e-02 -5.847001e-02  1.271470e+00
#> [856] -3.282007e-01 -8.239506e-01 -2.083042e-01  7.298608e-02  9.032324e-01
#> [861]  5.043291e-01  7.804401e-02 -7.855417e-01 -4.889516e-01 -8.179103e-02
#> [866]  1.413397e+00 -1.024881e+00  6.017211e-01 -3.017037e-01  9.153244e-01
#> [871] -6.281010e-01  8.311243e-02 -6.048862e-01  4.902754e-01  8.280683e-01
#> [876]  1.088714e+00  4.598171e-01  1.043391e+00  7.156721e-01 -6.947701e-02
#> [881]  2.650620e-01 -5.504429e-01 -9.565368e-02  6.731907e-01  3.074772e-01
#> [886]  2.606756e-01 -5.695846e-01 -3.299154e-01 -4.294976e-01  2.196565e-01
#> [891] -5.622205e-01  3.116706e-01 -6.142244e-01  1.034769e+00  2.586886e-01
#> [896] -4.013289e-01  1.638308e-01 -2.042001e-01  1.819958e-01  1.513304e-01
#> [901] -5.571540e-01 -4.206895e-01  1.677274e-01  9.047890e-01  6.096425e-01
#> [906] -3.324167e-01  4.467859e-01 -1.270480e-02  1.699412e-01  1.483401e-01
#> [911]  1.418183e+00 -6.561390e-01  5.703976e-02 -9.918171e-01  3.010674e-01
#> [916]  5.820317e-01  7.932212e-01 -1.080617e+00  2.197923e-01  8.864256e-01
#> [921] -2.234838e-01 -1.197174e-01 -4.576513e-02  2.300671e-01  3.702908e-01
#> [926]  7.181301e-01 -6.034794e-02  1.125726e-01  1.384332e+00  2.301526e-01
#> [931]  9.049929e-02 -7.641771e-01  1.497893e-02 -1.154434e-01 -1.289700e-03
#> [936] -3.206958e-01 -3.860681e-01 -3.938685e-01 -1.217939e-01  7.443382e-01
#> [941]  5.736632e-01 -2.070188e-01 -9.533332e-01 -4.718810e-01 -2.559793e-01
#> [946]  7.569068e-02 -3.957992e-01  1.124814e+00 -1.547668e-01 -6.999055e-01
#> [951] -1.044095e-01 -5.371147e-01  7.920534e-02  1.256059e-01
#> 
#> [[1]]$iter
#> [1] 853
#> 
#> [[1]]$terminate
#> [[1]]$terminate$what
#> [1] "abs_tol"
#> 
#> [[1]]$terminate$val
#> [1] 9.779325e-09
acmtf_model = acmtf_opt(Z, 3)
```
